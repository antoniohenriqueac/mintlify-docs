---
title: "Autentica√ß√£o"
description: "Como autenticar suas requisi√ß√µes com API Keys do ConnectVets Notes"
icon: "key"
---

# Autentica√ß√£o com API Keys üîê

O ConnectVets Notes usa **API Keys** para autenticar todas as requisi√ß√µes. √â simples, seguro e permite controle granular de acesso.

<Info>
**Todas as requisi√ß√µes** para a API ConnectVets Notes devem incluir uma API Key v√°lida no header `X-API-KEY`.
</Info>

## Como funciona

<Steps>
  <Step title="Obtenha uma API Key">
    Crie uma API Key no dashboard do ConnectVets Notes
  </Step>
  <Step title="Inclua no header">
    Adicione o header `X-API-KEY` em todas as requisi√ß√µes
  </Step>
  <Step title="Fa√ßa a requisi√ß√£o">
    Envie sua requisi√ß√£o - a autentica√ß√£o √© autom√°tica
  </Step>
</Steps>

## Criando uma API Key

### Pelo Dashboard Web

<Steps>
  <Step title="Acesse o Dashboard">
    Fa√ßa login em [notes.connectvets.com.br](https://notes.connectvets.com.br)
  </Step>
  <Step title="Navegue para API Keys">
    V√° para **Configura√ß√µes** ‚Üí **API Keys** no menu lateral
  </Step>
  <Step title="Crie uma nova chave">
    Clique em **"Nova API Key"** e preencha:
    - **Nome**: Identifique o uso (ex: "Integra√ß√£o Sistema X")
    - **Tipo**: Selecione as permiss√µes necess√°rias
    - **Expira√ß√£o**: Defina quando expira (opcional)
  </Step>
  <Step title="Copie a chave">
    ‚ö†Ô∏è **Importante**: Copie a chave imediatamente - ela s√≥ aparece uma vez!
  </Step>
</Steps>

### Via API (para automa√ß√£o)

<CodeGroup>
```bash cURL
curl -X POST "https://api.connectvets.com.br/v1/api-keys" \
  -H "X-API-KEY: your_admin_key" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Integra√ß√£o Sistema X",
    "permissions": ["notes:read", "notes:write"],
    "expires_at": "2024-12-31T23:59:59Z"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.connectvets.com.br/v1/api-keys', {
  method: 'POST',
  headers: {
    'X-API-KEY': 'your_admin_key',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    name: 'Integra√ß√£o Sistema X',
    permissions: ['notes:read', 'notes:write'],
    expires_at: '2024-12-31T23:59:59Z'
  })
});

const apiKey = await response.json();
console.log('Nova API Key:', apiKey.data.key);
```

```python Python
import requests

data = {
    'name': 'Integra√ß√£o Sistema X',
    'permissions': ['notes:read', 'notes:write'],
    'expires_at': '2024-12-31T23:59:59Z'
}

response = requests.post(
    'https://api.connectvets.com.br/v1/api-keys',
    headers={'X-API-KEY': 'your_admin_key'},
    json=data
)

api_key = response.json()
print(f"Nova API Key: {api_key['data']['key']}")
```
</CodeGroup>

## Usando API Keys

Inclua sua API Key no header `X-API-KEY` de todas as requisi√ß√µes:

<CodeGroup>
```bash cURL
curl -X GET "https://api.connectvets.com.br/v1/notes" \
  -H "X-API-KEY: cvn_1234567890abcdef" \
  -H "Content-Type: application/json"
```

```javascript JavaScript
// Fetch API
const response = await fetch('https://api.connectvets.com.br/v1/notes', {
  headers: {
    'X-API-KEY': 'cvn_1234567890abcdef',
    'Content-Type': 'application/json'
  }
});

// Axios
import axios from 'axios';

const api = axios.create({
  baseURL: 'https://api.connectvets.com.br/v1',
  headers: {
    'X-API-KEY': 'cvn_1234567890abcdef'
  }
});
```

```python Python
import requests

# Session com header padr√£o
session = requests.Session()
session.headers.update({
    'X-API-KEY': 'cvn_1234567890abcdef',
    'Content-Type': 'application/json'
})

response = session.get('https://api.connectvets.com.br/v1/notes')
```

```go Go
package main

import (
    "net/http"
)

func main() {
    client := &http.Client{}
    req, _ := http.NewRequest("GET", "https://api.connectvets.com.br/v1/notes", nil)
    
    req.Header.Add("X-API-KEY", "cvn_1234567890abcdef")
    req.Header.Add("Content-Type", "application/json")
    
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}
```
</CodeGroup>

## Tipos de API Keys

<CardGroup cols={3}>
  <Card title="Administrador" icon="crown" color="#f59e0b">
    **Permiss√µes**: Todas
    - Criar/deletar API Keys
    - Gerenciar usu√°rios
    - Acesso completo √†s notas
  </Card>
  <Card title="Editor" icon="pencil" color="#3b82f6">
    **Permiss√µes**: Leitura e escrita
    - Criar notas
    - Atualizar notas existentes
    - Visualizar todas as notas
  </Card>
  <Card title="Visualizador" icon="eye" color="#10b981">
    **Permiss√µes**: Somente leitura
    - Visualizar notas
    - Buscar e filtrar
    - Sem permiss√µes de escrita
  </Card>
</CardGroup>

## Anatomia de uma API Key

As API Keys do ConnectVets seguem um formato espec√≠fico para facilitar identifica√ß√£o:

<Frame>
```
cvn_1234567890abcdef1234567890abcdef
‚îÇ   ‚îÇ                                
‚îÇ   ‚îî‚îÄ‚îÄ Chave secreta (32 caracteres hex)
‚îî‚îÄ‚îÄ Prefixo identificador ConnectVets Notes
```
</Frame>

<Accordion title="Detalhes t√©cnicos">
- **Prefixo**: `cvn_` identifica chaves do ConnectVets Notes
- **Comprimento**: 36 caracteres total (4 do prefixo + 32 da chave)
- **Formato**: Hexadecimal (0-9, a-f)
- **Gera√ß√£o**: Cryptographically secure random
- **Encoding**: UTF-8
</Accordion>

## Seguran√ßa e Boas Pr√°ticas

<CardGroup cols={2}>
  <Card title="‚úÖ Fa√ßa" icon="check" color="#10b981">
    - Armazene em vari√°veis de ambiente
    - Use HTTPS em produ√ß√£o
    - Monitore uso das chaves
    - Rotacione chaves regularmente
    - Use chaves com permiss√µes m√≠nimas
  </Card>
  <Card title="‚ùå N√£o fa√ßa" icon="x" color="#ef4444">
    - Commitar chaves no c√≥digo
    - Logar chaves em arquivos
    - Compartilhar chaves por email/chat
    - Usar chaves de admin para tudo
    - Deixar chaves sem expira√ß√£o
  </Card>
</CardGroup>

### Armazenamento Seguro

<CodeGroup>
```bash Vari√°veis de Ambiente
# .env
CONNECTVETS_API_KEY=cvn_1234567890abcdef

# .bashrc ou .zshrc
export CONNECTVETS_API_KEY=cvn_1234567890abcdef
```

```javascript Node.js
// Usando dotenv
require('dotenv').config();

const apiKey = process.env.CONNECTVETS_API_KEY;

// Ou usando config
const config = {
  apiKey: process.env.CONNECTVETS_API_KEY || 'fallback_for_dev'
};
```

```python Python
import os
from dotenv import load_dotenv

load_dotenv()

API_KEY = os.getenv('CONNECTVETS_API_KEY')

# Ou usando python-decouple
from decouple import config
API_KEY = config('CONNECTVETS_API_KEY')
```

```go Go
package main

import (
    "os"
    "log"
)

func main() {
    apiKey := os.Getenv("CONNECTVETS_API_KEY")
    if apiKey == "" {
        log.Fatal("CONNECTVETS_API_KEY n√£o encontrada")
    }
}
```
</CodeGroup>

## Rate Limiting

API Keys t√™m limites de taxa baseados no tipo:

<CardGroup cols={3}>
  <Card title="Administrador" icon="crown" color="#f59e0b">
    **1000 req/min**
    Limite mais alto para opera√ß√µes administrativas
  </Card>
  <Card title="Editor" icon="pencil" color="#3b82f6">
    **500 req/min**
    Limite moderado para opera√ß√µes normais
  </Card>
  <Card title="Visualizador" icon="eye" color="#10b981">
    **200 req/min**
    Limite conservador para consultas
  </Card>
</CardGroup>

### Respondendo ao Rate Limiting

Quando voc√™ excede o limite, a API retorna `429 Too Many Requests`:

<CodeGroup>
```json Resposta 429
{
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Rate limit exceeded. Try again in 60 seconds.",
    "details": {
      "limit": 500,
      "remaining": 0,
      "reset_at": "2024-01-15T10:31:00Z"
    }
  }
}
```

```javascript Tratamento em JS
async function apiCall() {
  try {
    const response = await fetch(url, { headers });
    
    if (response.status === 429) {
      const resetTime = response.headers.get('X-RateLimit-Reset');
      const waitTime = new Date(resetTime) - new Date();
      
      console.log(`Rate limit hit. Waiting ${waitTime}ms...`);
      await new Promise(resolve => setTimeout(resolve, waitTime));
      
      return apiCall(); // Retry
    }
    
    return response.json();
  } catch (error) {
    console.error('API Error:', error);
  }
}
```

```python Tratamento em Python
import time
import requests

def api_call_with_retry():
    while True:
        response = requests.get(url, headers=headers)
        
        if response.status_code == 429:
            reset_time = response.headers.get('X-RateLimit-Reset')
            wait_time = int(reset_time) - int(time.time())
            
            print(f"Rate limit hit. Waiting {wait_time}s...")
            time.sleep(wait_time)
            continue
            
        return response.json()
```
</CodeGroup>

## Monitoramento e Logs

### Verificar uso de uma API Key

<CodeGroup>
```bash cURL
curl -X GET "https://api.connectvets.com.br/v1/api-keys/cvn_1234567890abcdef/usage" \
  -H "X-API-KEY: your_admin_key"
```

```javascript JavaScript
const usage = await fetch(`https://api.connectvets.com.br/v1/api-keys/${keyId}/usage`, {
  headers: { 'X-API-KEY': 'your_admin_key' }
});

const stats = await usage.json();
console.log('Uso da API Key:', stats.data);
```
</CodeGroup>

### Listar todas as API Keys

<CodeGroup>
```bash cURL
curl -X GET "https://api.connectvets.com.br/v1/api-keys" \
  -H "X-API-KEY: your_admin_key"
```

```javascript JavaScript
const keys = await fetch('https://api.connectvets.com.br/v1/api-keys', {
  headers: { 'X-API-KEY': 'your_admin_key' }
});

const apiKeys = await keys.json();
console.log('API Keys ativas:', apiKeys.data);
```
</CodeGroup>

## Rota√ß√£o de Chaves

Para manter a seguran√ßa, rotacione suas API Keys regularmente:

<Steps>
  <Step title="Crie uma nova API Key">
    Gere uma nova chave com as mesmas permiss√µes
  </Step>
  <Step title="Atualize seus sistemas">
    Substitua a chave antiga pela nova em todos os sistemas
  </Step>
  <Step title="Teste a integra√ß√£o">
    Verifique se tudo funciona com a nova chave
  </Step>
  <Step title="Revogue a chave antiga">
    Delete a chave antiga do dashboard
  </Step>
</Steps>

<Warning>
**Cuidado**: Sempre teste a nova chave antes de revogar a antiga para evitar interrup√ß√µes no servi√ßo.
</Warning>

## Resolu√ß√£o de Problemas

<AccordionGroup>
  <Accordion title="401 Unauthorized">
    **Poss√≠veis causas:**
    - API Key inv√°lida ou expirada
    - Header `X-API-KEY` ausente
    - Typo na chave

    **Solu√ß√µes:**
    - Verifique se a chave est√° correta
    - Confirme que o header est√° sendo enviado
    - Regenere a chave se necess√°rio
  </Accordion>

  <Accordion title="403 Forbidden">
    **Poss√≠veis causas:**
    - API Key sem permiss√µes suficientes
    - Tentativa de acessar recursos de outro tenant
    - Chave desabilitada

    **Solu√ß√µes:**
    - Use uma chave com permiss√µes adequadas
    - Verifique se est√° acessando o tenant correto
    - Confirme se a chave est√° ativa
  </Accordion>

  <Accordion title="429 Too Many Requests">
    **Poss√≠veis causas:**
    - Limite de rate excedido
    - Muitas requisi√ß√µes simult√¢neas

    **Solu√ß√µes:**
    - Implemente retry com backoff
    - Distribua requisi√ß√µes ao longo do tempo
    - Use cache para reduzir chamadas
  </Accordion>
</AccordionGroup>

## Pr√≥ximos passos

<CardGroup cols={2}>
  <Card title="Fazer primeira requisi√ß√£o" icon="play" href="/quickstart">
    Use sua API Key para processar o primeiro √°udio
  </Card>
  <Card title="Explorar endpoints" icon="code" href="/api-reference/overview">
    Veja todos os endpoints dispon√≠veis
  </Card>
  <Card title="Configurar webhooks" icon="webhook" href="/concepts/webhooks">
    Receba notifica√ß√µes autom√°ticas de eventos
  </Card>
  <Card title="Exemplos de integra√ß√£o" icon="puzzle-piece" href="/examples/basic-integration">
    Veja implementa√ß√µes pr√°ticas
  </Card>
</CardGroup> 