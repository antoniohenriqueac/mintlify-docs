---
title: 'Visão Geral da API'
description: 'Documentação completa da API REST do ConnectVets Notes'
---

## Base URL

```
https://api.connectvets.com
```

## Autenticação

Para todas as requisições utilize o header:

```http
X-API-KEY: <SUA_API_KEY>
```

Cada cliente possui uma chave única (`API_KEY`). Requisições sem este header, ou com chave inválida, receberão **HTTP 401 – Unauthorized**.

<Warning>
  Sua API Key é secreta! Nunca a compartilhe em código público ou logs.
</Warning>

## Onboarding

O processo de integração à plataforma ConnectVets Notes começa pela criação e gestão da sua **API KEY**, que identifica **uma Clínica/Workspace** de forma única.

### Gerar a chave
- O **dono da clínica** acessa o painel **ConnectVets Notes → Configurações → API Keys**.
- Clique em **"Gerar nova chave"**. Uma string longa (ex.: `cvn_live_abcdef123456`) será exibida **uma única vez**.
- A chave deve então ser enviada para a equipe/empresa responsável pela integração (ex.: DoctorVet).

### Armazenar com segurança
- Copie a chave imediatamente e guarde-a em um cofre de segredos (AWS Secrets Manager, Vault, KeePass, etc.) ou variável de ambiente.
- Nunca comprometa a chave em repositórios de código, screenshots ou logs.

### Utilizar em cada requisição
- Envie a chave no header `X-API-KEY`.
- Exemplo:

   ```http
   X-API-KEY: cvn_live_abcdef123456
   ```

### Rotação e múltiplas clínicas
- Você pode gerar **várias chaves**, cada uma representando um Tenant/Clínica diferente.
- Caso uma empresa gerencie múltiplas clínicas, salve e utilize a **API KEY correspondente** em cada requisição, conforme a clínica de destino.
- Para rotacionar, publique a nova chave nos seus sistemas, valide o funcionamento e, em seguida, revogue a chave antiga no painel.

<Info>
A **API KEY** identifica um **Workspace/Clínica** dentro da plataforma. Ela não expira por tempo; gerencie cada chave como um segredo de produção e mantenha um mapeamento claro quando lidar com múltiplas clínicas.
</Info>

## Convenções de Campos

* **UUIDs** são strings no formato RFC 4122.
* Datas e horários utilizam ISO 8601 em UTC (`YYYY-MM-DDThh:mm:ssZ`).

## Rate Limiting

A API implementa rate limiting baseado na API Key:

- **Limite por minuto**: 100-200 requisições
- **Limite por hora**: 1.000-2.000 requisições

Headers de resposta incluem informações sobre os limites:

```http
X-RateLimit-Limit-Minute: 100
X-RateLimit-Remaining-Minute: 87
X-RateLimit-Reset-Minute: 1642694400
```

## Formato de Resposta

### Sucesso

Todas as respostas de sucesso seguem um formato JSON consistente:

```json
{
  "data": {}, // ou array para listas
  "pagination": {} // apenas para endpoints paginados
}
```

### Erro

Respostas de erro incluem informações detalhadas:

```json
{
  "error": "bad_request",
  "message": "Invalid audio format",
  "code": "INVALID_AUDIO_FORMAT",
  "details": {
    "expected": "audio/wav",
    "received": "audio/mp3"
  }
}
```

## Códigos de Status HTTP

| Código | Significado | Descrição |
|--------|-------------|-----------|
| `200` | OK | Requisição bem-sucedida |
| `201` | Created | Recurso criado com sucesso |
| `400` | Bad Request | Dados inválidos na requisição |
| `401` | Unauthorized | API Key ausente ou inválida |
| `403` | Forbidden | Permissões insuficientes |
| `404` | Not Found | Recurso não encontrado |
| `422` | Unprocessable Entity | Dados válidos mas processamento falhou |
| `429` | Too Many Requests | Rate limit excedido |
| `500` | Internal Server Error | Erro interno do servidor |

## Tipos de Dados

### Note

```json
{
  "id": "uuid",
  "name": "string",
  "gender": "male|female|unidentified", 
  "audio_name": "string",
  "audio_url": "string",
  "transcription_status": "pending|processing|completed|failed",
  "transcription_url": "string",
  "external_id": "string",
  "metadata": [{"key": "string", "value": "string"}],
  "created_at": "2024-02-14T18:25:43Z",
  "updated_at": "2024-02-14T18:30:23Z"
}
```

### NoteSection

```json
{
  "id": "uuid",
  "title": "string",
  "label": "string", 
  "content": "string",
  "order": "string"
}
```

### ApiKey

```json
{
  "id": "uuid",
  "name": "string",
  "key_prefix": "string",
  "type": "read|write|admin",
  "rate_limit_per_minute": 100,
  "rate_limit_per_hour": 1000,
  "is_active": true,
  "created_at": "2024-02-14T18:25:43Z",
  "updated_at": "2024-02-14T18:30:23Z",
  "last_used_at": "2024-02-14T18:30:23Z"
}
```

## Paginação

Endpoints que retornam listas implementam paginação:

### Parâmetros de Query

- `page`: Número da página (padrão: 1)
- `per_page`: Itens por página (padrão: 20, máximo: 100)

### Resposta

```json
{
  "data": [...],
  "pagination": {
    "current_page": 1,
    "total_pages": 10,
    "total_items": 200,
    "per_page": 20
  }
}
```

## Filtros Comuns

Muitos endpoints suportam filtros via query parameters:

### Notes
- `external_id`: Filtrar por ID externo
- `transcription_status`: Filtrar por status
- `valid`: Filtrar por notas válidas/inválidas
- `name`: Busca parcial por nome do paciente
- `from` / `to`: Filtrar por data (YYYY-MM-DD)

### Exemplo
```
GET /notes?transcription_status=completed&from=2024-01-01&to=2024-01-31&page=2&per_page=50
```

## Content Types

### Upload de Áudio
```http
Content-Type: multipart/form-data
```

### JSON APIs
```http
Content-Type: application/json
```

## Headers Recomendados

```http
X-API-KEY: sua_chave_da_api
Content-Type: application/json
Accept: application/json
User-Agent: SeuApp/1.0.0
```

## Versionamento

A API atualmente está na versão 1 e é estável. Mudanças futuras serão:

- **Backward compatible**: Novos campos e endpoints
- **Breaking changes**: Nova versão da API (v2, v3, etc.)

## SDKs e Bibliotecas

### JavaScript/TypeScript
```bash
npm install @connectvets/notes-api
```

### Python
```bash
pip install connectvets-notes
```

### Go
```bash
go get github.com/connectvets/notes-go
```

## Endpoints Principais

<CardGroup cols={2}>
  <Card
    title="Notes"
    icon="file-text"
    href="/api-reference/notes/create"
  >
    Criar, listar e gerenciar notas de consultas
  </Card>
  <Card
    title="API Keys"
    icon="key"
    href="/api-reference/api-keys/create"
  >
    Gerenciar chaves de acesso à API
  </Card>
  <Card
    title="Webhooks" 
    icon="webhook"
    href="/api-reference/webhooks/create"
  >
    Configurar notificações automáticas
  </Card>
  <Card
    title="Note Sections"
    icon="list"
    href="/api-reference/notes/get"
  >
    Acessar seções estruturadas das notas
  </Card>
</CardGroup>

## Ambientes

### Produção
```
https://api.connectvets.com.br
```

### Desenvolvimento
```
http://localhost:8080
```

### Sandbox/Teste
```
https://api-sandbox.connectvets.com.br
```

<Tip>
  Use chaves de API diferentes para cada ambiente. Chaves de produção começam com `cvn_live_`, enquanto chaves de teste começam com `cvn_test_`
</Tip>

## Suporte

- **Documentação**: Esta documentação
- **Email**: suporte@connectvets.com.br
- **GitHub Issues**: Para bugs e melhorias
- **Status da API**: https://status.connectvets.com.br 