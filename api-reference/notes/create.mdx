---
title: "Criar Notes"
openapi: 'POST /notes'
description: "Envie √°udio para transcri√ß√£o e cria√ß√£o de nota veterin√°ria"
---

## Descri√ß√£o

Envia um arquivo de √°udio para transcri√ß√£o autom√°tica e cria√ß√£o de uma nova nota veterin√°ria. O √°udio ser√° processado por IA e dividido em se√ß√µes estruturadas.

## Requisitos de √Åudio

<Warning>
  **Regras de ouro para obter a melhor performance e acur√°cia:**
  
  1. Taxa de amostragem **16 kHz (16.000 Hz)**
  2. **Mono** (1 canal)
  3. **PCM linear sem compress√£o** ‚Äî se precisar compactar, utilize **FLAC** (lossless)
  
  **Formato recomendado: "WAV ‚Äì 16 kHz ‚Äì 16-bit ‚Äì mono"**
</Warning>

### Formatos Aceitos

| Formato | Status | Qualidade | Observa√ß√µes |
|---------|--------|-----------|-------------|
| **WAV** | ‚úÖ Recomendado | Excelente | PCM linear 16-bit, 16kHz, mono |
| **FLAC** | ‚úÖ Bom | Muito boa | Compress√£o sem perda |
| MP3 | ‚ö†Ô∏è Aceito | Reduzida | N√£o recomendado |
| M4A | ‚ö†Ô∏è Aceito | Reduzida | N√£o recomendado |

## Par√¢metros da Requisi√ß√£o

### Headers

| Header | Obrigat√≥rio | Valor |
|--------|-------------|--------|
| `X-API-KEY` | ‚úÖ Sim | Sua chave de API |
| `Content-Type` | ‚úÖ Sim | `multipart/form-data` |

### Body (multipart/form-data)

| Campo | Tipo | Obrigat√≥rio | Descri√ß√£o |
|-------|------|-------------|-----------|
| `audio` | File | ‚úÖ Sim | Arquivo de √°udio (WAV/FLAC recomendado) |
| `name` | String | ‚úÖ Sim | Nome do paciente |
| `external_id` | String | ‚ùå N√£o | ID do seu sistema para refer√™ncia |
| `gender` | Enum | ‚ùå N√£o | Sexo: `male`, `female`, `unidentified` (padr√£o) |
| `metadata` | String (JSON) | ‚ùå N√£o | Metadados adicionais em formato JSON |

### Exemplo de Metadados

```json
[
  {"key": "procedimento", "value": "vacina"},
  {"key": "peso", "value": "12.5kg"},
  {"key": "idade", "value": "3 anos"},
  {"key": "veterinario", "value": "Dr. Jo√£o Silva"}
]
```

<RequestExample>

```bash cURL
curl -X POST https://api.connectvets.com.br/notes \
  -H "X-API-KEY: cvn_live_abc123def456..." \
  -F "audio=@consulta_rex_20240214.wav" \
  -F "name=Rex" \
  -F "external_id=CLIENTE_123" \
  -F "gender=male" \
  -F 'metadata=[{"key":"procedimento","value":"vacina"}]'
```

```javascript
const formData = new FormData();
formData.append('audio', audioFile);
formData.append('name', 'Rex');
formData.append('external_id', 'CLIENTE_123');
formData.append('gender', 'male');
formData.append('metadata', JSON.stringify([
  {"key": "procedimento", "value": "vacina"}
]));

const response = await fetch('https://api.connectvets.com.br/notes', {
  method: 'POST',
  headers: {
    'X-API-KEY': 'cvn_live_abc123def456...'
  },
  body: formData
});

const note = await response.json();
```

```python
import requests

url = "https://api.connectvets.com.br/notes"
headers = {
    "X-API-KEY": "cvn_live_abc123def456..."
}

files = {
    'audio': ('consulta_rex.wav', open('consulta_rex.wav', 'rb'), 'audio/wav')
}

data = {
    'name': 'Rex',
    'external_id': 'CLIENTE_123',
    'gender': 'male',
    'metadata': '[{"key":"procedimento","value":"vacina"}]'
}

response = requests.post(url, headers=headers, files=files, data=data)
note = response.json()
```

</RequestExample>

<ResponseExample>

```json Response
{
  "id": "6a4fe1de-52c4-4b2b-a30f-4b3fa9d7d8b3",
  "name": "Rex",
  "gender": "male",
  "audio_name": "consulta_rex_20240214.wav",
  "audio_url": "https://cdn.connectvets.com.br/audio/6a4fe1de.wav",
  "transcription_status": "pending",
  "transcription_url": null,
  "external_id": "CLIENTE_123",
  "metadata": [
    {"key": "procedimento", "value": "vacina"}
  ],
  "note_sections": [],
  "created_at": "2024-02-14T18:25:43Z",
  "updated_at": "2024-02-14T18:25:43Z"
}
```

</ResponseExample>

### Status da Transcri√ß√£o

A nota √© criada imediatamente com status `pending`. O processamento acontece de forma ass√≠ncrona:

| Status | Descri√ß√£o | Tempo Estimado |
|--------|-----------|----------------|
| `pending` | Aguardando processamento | Imediato |
| `processing` | IA transcrevendo o √°udio | 2-5 minutos |
| `completed` | Transcri√ß√£o finalizada | - |
| `failed` | Erro no processamento | - |

### Erros Comuns

#### 400 Bad Request

```json
{
  "error": "bad_request",
  "message": "Audio file is required",
  "code": "MISSING_AUDIO_FILE"
}
```

**Causas poss√≠veis:**
- Arquivo de √°udio n√£o enviado
- Nome do paciente n√£o informado
- Formato de metadata inv√°lido

#### 401 Unauthorized

```json
{
  "error": "unauthorized",
  "message": "API key is required",
  "code": "MISSING_API_KEY"
}
```

#### 402 Payment Required

```json
{
  "error": "payment_required",
  "message": "Subscription inactive or limit exceeded",
  "code": "SUBSCRIPTION_INACTIVE"
}
```

#### 413 Payload Too Large

```json
{
  "error": "payload_too_large",
  "message": "Audio file exceeds maximum size of 100MB",
  "code": "FILE_TOO_LARGE"
}
```

#### 422 Unprocessable Entity

```json
{
  "error": "unprocessable_entity",
  "message": "Invalid audio format",
  "code": "INVALID_AUDIO_FORMAT",
  "details": {
    "expected": "audio/wav, audio/flac",
    "received": "audio/mp3"
  }
}
```

## Monitoramento do Processamento

### Webhook (Recomendado)

Configure webhooks para receber notifica√ß√µes autom√°ticas:

```json
{
  "event": "note.completed",
  "data": {
    "id": "6a4fe1de-52c4-4b2b-a30f-4b3fa9d7d8b3",
    "name": "Rex",
    "transcription_status": "completed",
    "external_id": "CLIENTE_123"
  },
  "timestamp": "2024-02-14T18:30:23Z"
}
```

### Polling

Consulte periodicamente o status da nota:

```javascript
async function waitForCompletion(noteId) {
  let status = 'pending';
  
  while (status === 'pending' || status === 'processing') {
    await new Promise(resolve => setTimeout(resolve, 30000)); // 30s
    
    const response = await fetch(`/notes/${noteId}`, {
      headers: { 'X-API-KEY': apiKey }
    });
    
    const note = await response.json();
    status = note.transcription_status;
    
    if (status === 'completed') {
      console.log('Transcri√ß√£o finalizada!');
      console.log('Se√ß√µes:', note.note_sections.length);
      break;
    } else if (status === 'failed') {
      console.error('Erro no processamento');
      break;
    }
  }
}
```

## Limites e Restri√ß√µes

### Limites de Upload

| Limite | Valor | Observa√ß√£o |
|--------|-------|------------|
| **Tamanho m√°ximo** | 100 MB | Por arquivo |
| **Dura√ß√£o m√°xima** | 2 horas | √Åudio muito longo pode falhar |
| **Formato** | WAV, FLAC, MP3, M4A | WAV recomendado |
| **Taxa de upload** | 10 por minuto | Por API Key |

### Limites por Plano

| Plano | Notas/m√™s | Tamanho | Reten√ß√£o |
|-------|-----------|---------|----------|
| **Gratuito** | 10 | 50 MB | 30 dias |
| **Profissional** | 500 | 100 MB | 1 ano |
| **Enterprise** | Ilimitado | 200 MB | Customiz√°vel |

## Melhores Pr√°ticas

### üéôÔ∏è Qualidade do √Åudio

- **Ambiente silencioso**: Minimize ru√≠do de fundo
- **Dist√¢ncia adequada**: 30-50cm do microfone
- **Volume consistente**: Evite varia√ß√µes extremas
- **Fala clara**: Pronuncie bem as palavras t√©cnicas

### üîß Integra√ß√£o

- **Use external_id**: Para vincular com seu sistema
- **Configure webhooks**: Para notifica√ß√µes em tempo real
- **Trate erros**: Implemente retry com backoff exponencial
- **Monitore limites**: Acompanhe uso da API

### üìä Metadados √öteis

```json
[
  {"key": "procedimento", "value": "consulta de rotina"},
  {"key": "veterinario", "value": "Dr. Jo√£o Silva"},
  {"key": "peso", "value": "12.5kg"},
  {"key": "temperatura", "value": "38.5¬∞C"},
  {"key": "pressao", "value": "normal"},
  {"key": "observacoes", "value": "animal cooperativo"}
]
```

## Pr√≥ximos Passos

<CardGroup cols={2}>
  <Card
    title="Listar Notas"
    icon="list"
    href="/api-reference/notes/list"
  >
    Como buscar e filtrar suas notas
  </Card>
  <Card
    title="Obter Nota por ID"
    icon="magnifying-glass"
    href="/api-reference/notes/get"
  >
    Acesse detalhes e se√ß√µes da nota
  </Card>
  <Card
    title="Configurar Webhooks"
    icon="webhook"
    href="/concepts/webhooks"
  >
    Receba notifica√ß√µes autom√°ticas
  </Card>
  <Card
    title="Filtros Avan√ßados"
    icon="filter"
    href="/examples/advanced-filtering"
  >
    Exemplos de busca e filtros
  </Card>
</CardGroup> 